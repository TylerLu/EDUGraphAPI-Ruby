$(document).ready(function(){function e(e){e.hover(function(){$(this).children().last().show()},function(){$(this).children().last().hide()}).find(".detail #termdate").each(function(e,s){var t=$(s),a=t.text();a&&t.text(moment.utc(a).local().format("MMMM D YYYY"))})}function s(e){var s;e?(s="",$(".txtsearch").val("")):s=$(".txtsearch").val(),s?$(".tile-container h2").each(function(){$(this).text().search(new RegExp(s,"i"))<0?$(this).closest(".tile-container").hide():$(this).closest(".tile-container").show()}):$(".tile-container").show()}e($(".section-tiles .tile-container")),$(".sections .filterlink-container .filterlink").click(function(){s(!0);var e=$(this);e.addClass("selected").siblings("a").removeClass("selected");var t=e.data("type"),a=$(".sections .tiles-root-container");a.removeClass(a.attr("class").replace("tiles-root-container","")).addClass(t+"-container")}),$("#see-more").click(function(){s(!0);var t=$(this),a=t.data("token"),i=t.data("school-number"),n=t.data("school-id"),c=t.data("url-params");t.find("span").addClass("disabled"),""!=a&&$.ajax({type:"POST",url:"/schools/"+n+"/next_class",dataType:"json",data:{school_number:i,skip_token:a,school_id:n,url_params:c},success:function(s){var a="";$.each(s.values,function(e,t){a+='<div class="tile-container">',a+=1==t.is_my_course?'<a class="mysectionlink" href="/schools/'+s.school_id+"/classes/"+t.class_id+"?"+s.url_params+'"><div class="tile"><h5>'+t.displayName+"</h5><h2>"+t.course_subject+t.course_number+"</h2></div></a>":'<div class="tile"><h5>'+t.displayName+"</h5><h2>"+t.course_subject+t.course_number+"</h2></div>",a+='<div class="detail"><h5>Course Id:</h5><h6>'+t.course_id+"</h6><h5>Description:</h5><h6>"+t.course_desc+"</h6><h5>Teachers:</h5><h5>Term Name:</h5><h6>"+t.teacher_name+'</h6><h5>Start/Finish Date:</h5><h6><span id="termdate">'+t.start_time+'</span><span> ~ </span><span id="termdate">'+t.end_time+"</span></h6><h5>Period:</h5><h6>"+t.period+"</h6></div>",a+="</div>"}),_=$(a),_.appendTo($("#class_content")).hide().fadeIn("slow"),e(_),t.data("token",s.skip_token),t.find("span").removeClass("disabled")}})}),$("#my-see-more").click(function(){s(!0);for(var e=parseInt($(this).data("index")),t=parseInt($(this).data("count")),a=e;a<e+12;a++){if(a>=t)return $(this).unbind("click"),void $(this).find("span").html("END");$("#my_course_"+a).removeClass("hidden_course")}$(this).data("index",e+12)}),$("#btnsearch").click(function(){s()}),$(".txtsearch").on("keypress",function(e){13===e.which&&s()})});